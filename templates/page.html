{% extends 'base.html' %}

{% block main %}
	<h1><a href='{{ page.permalink }}' rel=bookmark>{{ page.title | safe }}</a></h1>

	{%- if not page.meta.publish %}
	<p class=warning>This page has `publish` set to `false` in it's metadata.</p>
	{%- endif %}

	<div class=title-meta>
		{%- if page.layout != 'page' and (page.date or page.tags) %}
		<div class=title-subtext>
			{%- if page.date %}
			<time datetime='{{ page.date_iso }}'>{{ page.date_display }}</time>
			{%- endif %}
			{%- for tag in page.tags %}
			<a href='/tags/{{ tag }}/' title='Posts tagged with #{{ tag }}' class=tag rel=tag>{{ tag }}</a>
			{%- endfor %}
		</div>
		{%- endif %}

		{%- include 'share-links.html' %}
	</div>

	<article>{{ page.html_body | safe }}</article>

	{%- if page.layout == 'post' %}
	<section class=page-end-mark>&#x1f64f;</section>
	{%- include 'share-links.html' %}
	{%- endif %}

	{%- if page.layout == 'post' and config.dev_mode %}
	<section class=page-author>
		<h2>About the author</h2>
		<p>Hello, I am Shrikant! I love programming and quantitative financial topics. I mostly
		write about Python, JavaScript and ViM following my work and experiences. Thank you for
		checking out my blog! <a href='/contact/'>Say hello!</a></p>

		<p>Please share your thoughts and feedback in the comments below. Thanks!</p>

		<fieldset>
			<legend>Support my work</legend>
			<p class=support-links>
			<a href='https://www.buymeacoffee.com/sharat87' target=_blank title='No signup required'>
				<img src='/bmac.png' alt='Buy me a coffee!'></a>
			</p>
		</fieldset>

		{%- if page %}
		<fieldset>
			<legend>Share this article</legend>
		</fieldset>
		{%- endif %}

	</section>
	{% endif %}

	{% if page.meta.comments %}
	<section class=comments>
		<h2>Comments</h2>
		<div id=disqus_thread></div>
		<button type=button onclick='loadComments(event)'>Load comments</button>
		<noscript><p>Comments require JavaScript to be enabled.
			<a href='http://enable-javascript.com'>Learn how to do this for your browser</a>.</p></noscript>
	</section>
	<script>
	function disqus_config() {
		this.page.url = '{% if page.meta.disqus_url %}{{ page.meta.disqus_url }}{% else %}{{ page.permalink }}{%- endif %}';
	}
	function loadComments(event) {
		event.target.remove();
		document.getElementById('disqus_thread').innerText = 'Loading comments...';
		const s = document.createElement('script');
		s.async = true;
		s.src = '//sharats-me.disqus.com/embed.js';
		s.setAttribute('data-timestamp', +new Date());
		document.body.appendChild(s);
	}
	</script>
	{% endif %}

{% endblock %}
