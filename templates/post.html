{% extends 'base.html' %}

{% block main %}
	<h1><a href='{{ post.permalink }}' rel=bookmark>{{ post.title | safe }}</a></h1>

	{%- if not post.meta.publish %}
	<p class=warning>This post has `publish` set to `false` in it's metadata.</p>
	{%- endif %}

	{%- if post.layout != 'page' and (post.date or post.tags) %}
	<div class=title-subtext>
		{% if post.date %}
		<time datetime='{{ post.date_iso }}'>{{ post.date_display }}</time>
		{% endif %}
		{% for tag in post.tags %}
		<a href='/tags/{{ tag }}/' title='Posts tagged with #{{ tag }}' class=tag rel=tag>{{ tag }}</a>
		{% endfor %}
	</div>
	{%- endif %}

	<article>{{ post.html_body | safe }}</article>

	{%- if post.layout == 'post' %}
	<section class=post-end-mark>&#x1f64f;</section>
	{%- endif %}

	{%- if post.layout == 'post' and config.dev_mode %}
	<section class=post-author>
		<h2>About the author</h2>
		<p>Hello, I am Shrikant! I love programming and quantitative financial topics. I mostly
		write about Python, JavaScript and ViM following my work and experiences. Thank you for
		checking out my blog! <a href='/contact/'>Say hello!</a></p>

		<fieldset>
			<legend>Support my work</legend>
			<p class=support-links>
			<a href='https://www.buymeacoffee.com/sharat87' target=_blank title='No signup required'>
				<img src='/bmac.png' alt='Buy me a coffee!'></a>
			</p>
		</fieldset>

		{%- if post %}
		<fieldset>
			<legend>Share this article</legend>
			<p class=share-links>
			<a href='https://twitter.com/intent/tweet?url={{ post.permalink }}&text={{ post.title }}
				{%- if config.twitter_user %}&via={{ config.twitter_user }}{% endif -%}
				{%- if post.tags %}&hashtags={{ post.tags | join(', ') }}{% endif -%}'
				target=_blank title='Share on Twitter'>Twitter</a>
			{%- if config.facebook_app_id %}
			<a href='https://www.facebook.com/dialog/share?app_id={{ config.facebook_app_id }}&display=page&href={{ post.permalink }}&redirect_uri={{ post.permalink }}'
				target=_blank title='Share on Facebook'>Facebook</a>
			{%- endif %}
			<a href='https://www.linkedin.com/shareArticle?mini=true&url={{ post.permalink }}&title={{ post.title }}
				{%- if post.meta.desc %}&summary={{ post.meta.desc }}{% endif -%}'
				target=_blank title='Share on LinkedIn'>LinkedIn</a>
			</p>
		</fieldset>
		{%- endif %}

	</section>
	{% endif %}

	{% if post.meta.comments %}
	<section class=comments>
		<h2>Comments</h2>
		<div id=disqus_thread></div>
		<button type=button onclick='loadComments(event)'>Load comments</button>
		<noscript><p>Comments require JavaScript to be enabled.
			<a href='http://enable-javascript.com'>Learn how to do this for your browser</a>.</p></noscript>
	</section>
	<script>
	function disqus_config() {
		this.page.url = '{% if post.meta.disqus_url %}{{ post.meta.disqus_url }}{% else %}{{ post.permalink }}{%- endif %}';
	}
	function loadComments(event) {
		event.target.remove();
		document.getElementById('disqus_thread').innerText = 'Loading comments...';
		const s = document.createElement('script');
		s.async = true;
		s.src = '//sharats-me.disqus.com/embed.js';
		s.setAttribute('data-timestamp', +new Date());
		document.body.appendChild(s);
	}
	</script>
	{% endif %}

{% endblock %}
