{% extends 'base.html' %}

{% block main %}
	<h1><a href="{{ post.permalink }}" rel=bookmark>{{ post.title | safe }}</a></h1>

	{% if post.date or post.tags %}
	<em>
		{% if post.date %}
		Posted <time datetime='{{ post.date_iso }}'>{{ post.date_display }}</time>.
		{% endif %}
		{% if post.tags %}
			<span class="tag-list">
				Tagged:
				{% for tag in post.tags %} <a href="/tags/{{ tag }}.html">#{{ tag }}</a>{% endfor %}.
			</span>
		{% endif %}
	</em>
	{% endif %}

	<article> {{ post.html_body | safe }} </article>

	{% if not post.meta.no_comments %}
	<section class=comments>
		<h2>Comments</h2>
		<div id=disqus_thread></div>
	</section>

	<script>
	function disqus_config() {
		this.page.url = '{% if post.meta.disqus_url %}{{ post.meta.disqus_url }}{% else %}{{ post.permalink }}{%- endif %}';
	}
	const el = document.getElementById('disqus_thread');
	if (location.hostname.match(/localhost/)) {
		el.innerHTML = 'Disqus disabled for <b>' + location.hostname + '</b>.';
	} else {
		const s = document.createElement('script');
		s.async = true;
		s.src = '//sharats-me.disqus.com/embed.js';
		s.setAttribute('data-timestamp', +new Date());
		el.insertAdjacentHTML('afterEnd',
			`<script async src='//sharats-me.disqus.com/embed.js' data-timestamp=${+new Date}></` + `script>`);
	}
	</script>
	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	{% endif %}

{% endblock %}
