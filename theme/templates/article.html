{% extends "base.html" %}

{% block html_lang %}{{ article.lang }}{% endblock %}

{% block head -%}
{{ super() -}}
{%- if article.summary -%}
	<meta name=description content="{{ article.summary | striptags | safe | truncate(150) }}">
{%- endif -%}
{% endblock %}

{% block title %}{{ article.title | striptags }}{% endblock %}

{% block extra_head %}
{% import 'translations.html' as translations with context %}
{% if translations.entry_hreflang(article) %}
	{{ translations.entry_hreflang(article) }}
{% endif %}
{% endblock %}

{% block content %}
<h1>{{ article.title | markdown }}</h1>
<time datetime="{{ article.date.isoformat() }}" style="font-size: .8em; color: #888;">{{ article.locale_date }}</time>

{%- if article.subtitle %}
<div class=subtitle>{{ article.subtitle }}</div>
{%- endif %}

<p class=print-only>
<em>
<b>Published:</b> {{ article.locale_date }}<br>
{%- if article.authors %}
<b>Author:</b> {% for author in article.authors %}{{ author }}{% endfor %}<br>
{%- endif %}
</em>
</p>

<p class=print-only>
<em>
Thank you for printing from <a href="{{ PROD_SITEURL }}">sharats.me</a>. Do check back regularly for more such
awesome content. Subscribe to at sharats.me/posts/index.xml to stay updated.
</em>
</p>

<article>{{ article.content }}</article>

{%- if article.hn_id or article.reddit_url %}
<p><b>Discuss on</b>:
{%- if article.hn_id %}
	<a target=_blank href="https://news.ycombinator.com/item?id={{ article.hn_id }}">Hacker News</a>
{%- endif %}
{%- if article.hn_id and article.reddit_url %} or {% endif %}
{%- if article.reddit_url %}
	<a target=_blank href="https://www.reddit.com/{{ article.reddit_url }}">Reddit</a>
{%- endif -%}
.</p>
{%- endif %}

{% if DISQUS_SITENAME and SITEURL and article.status != "draft" %}
<hr>
<section class=comments>
	<h2>Comments</h2>
	<p class=print-only>View comments at <a href="{{ SITEURL }}/{{ article.url }}#comments">{{ SITEURL }}/{{ article.url }}#comments</a>
	<div id=disqus_thread>
		<button type=button onclick="loadComments(event)" class=screen-only style="margin:0 1em">Load comments</button>
	</div>
	<noscript class=screen-only><p>Comments require JavaScript to be enabled.
		<a href='http://enable-javascript.com'>Learn how to do this for your browser</a>.</p></noscript>
</section>
<script>
	const DISQUS_SITENAME = "{{ DISQUS_SITENAME }}";
	function disqus_config() {
		this.page.url = "{{ PROD_SITEURL }}/{{ article.url }}";
		this.page.identifier = "{{ article.disqus_id or article.slug }}";
	}
</script>
{% endif %}
{% endblock %}
